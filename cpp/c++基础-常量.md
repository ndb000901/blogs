# c++基础-常量


常量（Constant）是指 **在程序运行期间不可改变** 的变量，它提高了程序的安全性、可读性和可维护性。

---

## 1. 常量分类

| 分类            | 关键字/用法             | 示例                          |
|-----------------|-------------------------|-------------------------------|
| 字面量常量       | 直接使用的常量值        | `42`, `3.14`, `'A'`, `"Hello"`|
| `const`常量     | 编译期或运行期常量      | `const int x = 10;`           |
| `constexpr`常量 | 编译期常量（C++11起）   | `constexpr int size = 100;`   |
| 宏常量          | `#define`定义的常量     | `#define PI 3.14`             |
| 枚举常量        | `enum` / `enum class`   | `enum Color { RED, BLUE };`   |
| `const`指针常量 | 限定指针或数据不可变   | `const int* p; int* const p;` |

---

### 1.1 字面量常量

| 类型     | 示例值     | 说明                 |
|----------|------------|----------------------|
| 整型     | `123`, `0xFF`, `075` | 十进制、十六进制、八进制等 |
| 浮点型   | `3.14`, `1.0e-5`     | 科学计数法也支持            |
| 字符     | `'A'`, `'\n'`        | 单字符或转义字符            |
| 字符串   | `"hello"`            | 字符串字面量（C风格）       |
| 布尔值   | `true`, `false`      | 逻辑值                      |

**示例：**

```cpp
int a = 42;
char c = 'Z';
const char* msg = "Hello, World!";
```

---

### 1.2 const` 常量

- 表示 **只读变量**，初始化后值不可变。
- 可用于局部变量、全局变量、函数参数等。

| 用法                  | 示例                        |
|-----------------------|-----------------------------|
| 定义常量              | `const int max = 100;`      |
| 修饰函数参数          | `void foo(const int x)`     |
| 修饰指针              | `const int* p; int* const p;` |

一个有用的记忆方法是从右向左阅读声明：

- `const int* p;`: p 是一个指针 (*), 指向 (int*) 一个 const int。表示指针 p 不能用来修改它所指向的 int 值。但是，指针 p 本身是可变的，你可以让 p 指向另一个 int 变量
- `int* const p;`: p 是一个 const 指针 (* const), 指向一个 int (int*)。表示指针 p 本身是不可变的，但是指向的值可以改变。



---

### 1.3 `constexpr` 常量（C++11 起）

> 表示“**编译期常量**”，可用于数组大小、模板参数等，效率更高。

| 特性               | 描述                                           |
|--------------------|------------------------------------------------|
| 编译期间计算        | 必须能在编译期间确定其值                     |
| 可用于数组/模板参数 | 如：`int a[constexpr_value];`               |
| 函数也可声明为 `constexpr` | `constexpr int square(int x) { return x*x; }` |


#### 1.3.1 **`const` (常量):**

* **含义：** `const` 关键字用于声明一个变量或对象在初始化之后其值**不应该**被修改。
* **初始化时间：** `const` 变量可以在**编译时**或**运行时**初始化。只要在初始化后不再修改即可。
* **强调：** `const` 主要强调的是**只读性 (read-only)**。
* **用法：**
    * 声明常量变量：`const int MAX_VALUE = 100;`
    * 声明指向常量数据的指针：`const int* ptr;` (指针指向的数据不可修改)
    * 声明常量指针：`int* const ptr;` (指针本身不可修改)
    * 声明指向常量数据的常量指针：`const int* const ptr;`
    * 声明常量引用：`const int& ref = some_variable;`
    * 声明 `const` 成员函数：表示该成员函数不会修改对象的状态。

#### 1.3.2 **`constexpr` (常量表达式):**

* **含义：** `constexpr` 关键字用于声明一个变量或函数（或构造函数）的值可以在**编译时**被计算出来。
* **初始化时间：** `constexpr` 变量**必须**在**编译时**被初始化，其初始值必须是一个常量表达式。
* **强调：** `constexpr` 不仅强调只读性，更强调**编译时可求值 (can be evaluated at compile time)**。
* **用法：**
    * 声明编译时常量变量：`constexpr int SIZE = 10;`
    * 声明可以在常量表达式中使用的函数：`constexpr int square(int n) { return n * n; }`
    * 声明可以在常量表达式中使用的构造函数（C++11 及更高版本）：`struct Point { constexpr Point(int x, int y) : x_(x), y_(y) {} int x_, y_; };`



### 1.4 宏常量（不推荐）

```cpp
#define PI 3.14
#define NAME "Alice"
```

| 特点             | 问题                    |
|------------------|-------------------------|
| 编译前替换       | 无作用域、无类型检查   |
| 无调试信息       | 不利于排错             |
| 推荐用 `const`   | 类型安全，有作用域     |

---

### 1.5 枚举常量

### 传统 `enum`

```cpp
enum Color { RED, GREEN, BLUE };
```

### 强类型 `enum class`（C++11）

```cpp
enum class Direction { LEFT, RIGHT };
Direction d = Direction::LEFT;
```

| 特性              | `enum`             | `enum class`         |
|-------------------|--------------------|-----------------------|
| 是否污染全局作用域 | 是                 | 否                    |
| 是否强类型        | 否（可隐式转int）   | 是（需显式转换）       |

