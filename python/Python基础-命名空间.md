# Python基础-命名空间

## 1.命名空间（Namespace）

命名空间是 **名字到对象的映射关系**，即：**变量名 → 对应的对象/值**。你可以把命名空间想象成一个字典，它存储了程序中所有的名字。

```python
a = 10
# 这意味着在某个命名空间中，存在一个绑定：'a' -> 10
```

---

## 2. 命名空间的分类（3大类）

Python 中常见的命名空间分为以下几类：

| 命名空间类型    | 说明                                         | 生命周期 |
|------------------|----------------------------------------------|----------|
| **内置命名空间** | Python 启动时创建，包含内置函数如 `len()`    | 程序运行期间一直存在 |
| **全局命名空间** | 每个模块对应一个全局命名空间（模块级变量）   | 模块加载时创建，模块执行完后仍保留 |
| **局部命名空间** | 函数或方法中创建的命名空间（局部变量）       | 函数调用时创建，调用结束销毁 |

额外：
- 类也有自己的命名空间（类变量、方法）
- 闭包中还涉及 **自由变量**（nonlocal）

---

## 3. 命名空间的查找规则：LEGB

当 Python 解释器访问一个变量名时，会按照以下顺序查找：

```
L → Local          （局部作用域，函数/方法内部）
E → Enclosing      （嵌套作用域，外部嵌套函数中，但非全局）
G → Global         （模块级作用域）
B → Built-in       （Python内置作用域）
```

举例说明：

```python
x = "global"

def outer():
    x = "enclosing"

    def inner():
        x = "local"
        print(x)

    inner()

outer()
```

如果我们在 `inner()` 中不定义 `x`，那么它会继续往上找 enclosing → global → built-in。

---

## 4. 查看命名空间的函数

```python
locals()    # 查看当前局部命名空间（返回字典）
globals()   # 查看当前全局命名空间（模块级字典）
dir()       # 查看当前作用域下可访问的名字
```

示例：

```python
x = 42
print(globals())
```

---

## 5. 与作用域（scope）的区别与关系

- **命名空间** 是名字到对象的映射关系。
- **作用域** 是程序中代码可以访问某个命名空间的区域。

> 通俗来说：**命名空间是存储位置，作用域是访问路径。**

---

## 6. 命名空间在函数中的变化

```python
x = "global"

def foo():
    x = "local"
    print(x)

foo()  # 打印 local
print(x)  # 打印 global，说明全局未被改变
```

修改全局变量需要使用 `global`：

```python
x = 10

def change():
    global x
    x = 20

change()
print(x)  # 20
```

---

## 7. nonlocal 关键字

当你在嵌套函数中想修改外部（非全局）的变量，用 `nonlocal`：

```python
def outer():
    x = 10
    def inner():
        nonlocal x
        x = 20
    inner()
    print(x)  # 20

outer()
```

---

## 8. 命名空间的层级结构

```python
┌────────────┐
│ Built-in   │ ← 内置函数，比如 len()
├────────────┤
│ Global     │ ← 模块级变量
├────────────┤
│ Enclosing  │ ← 嵌套函数的外部函数变量
├────────────┤
│ Local      │ ← 当前函数的局部变量
└────────────┘
```

---