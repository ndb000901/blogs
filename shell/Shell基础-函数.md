# Shell基础-函数

## 1. 函数定义和调用

### 1.1 函数定义

函数的基本定义形式如下：

```bash

function 函数名 {
  # 函数体
}
```

或者，使用传统的方式：

```bash

函数名 () {
  # 函数体
}
```

### 2. 函数调用

定义完函数后，可以通过直接调用函数名来执行它。例如：

```bash

myfunc  # 调用名为 myfunc 的函数
```

---

## 2. 函数的返回值

在 Shell 中，**函数的返回值** 是通过 `return` 语句指定的，但返回的值只能是 **整数**（0 到 255）。通常，返回值用来表示函数执行是否成功：`0` 表示成功，其他值表示失败。

```bash

myfunc() {
  return 1  # 返回非零值表示发生错误
}

myfunc
echo $?  # 显示上一个命令的返回值
```

### 函数的标准输出：

如果希望函数返回一个字符串或其他类型的结果，可以使用 `echo` 输出值：

```bash

myfunc() {
  echo "Hello, World!"
}

result=$(myfunc)
echo $result  # 输出函数返回的字符串   
```

---

## 3. 函数参数

Shell 函数可以接受参数，在函数内部通过 `$1`, `$2`, `$3` 等来访问这些参数。参数以空格分隔，最多可以接收 9 个位置参数 `$1` 到 `$9`。如果参数超过 9 个，可以使用 `${10}`, `${11}` 等格式来访问。

### 3.1 传递参数给函数

```bash

greet() {
  echo "Hello, $1!"
}

greet "Alice"  # 输出：Hello, Alice!
```

### 3.2 函数内部的参数

- `$#`：传递给脚本或函数的参数个数
- `$@`：所有的参数（作为单独的字符串）
- `$*`：所有的参数（作为单一的字符串）

例如：

```bash

show_params() {
  echo "参数个数: $#"
  echo "所有参数: $@"
  echo "所有参数 (作为单一字符串): $*"
}

show_params "Alice" "Bob" "Charlie"
```

输出：

```
参数个数: 3
所有参数: Alice Bob Charlie
所有参数 (作为单一字符串): Alice Bob Charlie
```

### 3.3 获取所有参数

如果要获取所有的参数，可以使用 `$@` 或 `$*`。它们的区别是：

- `$@` 会把每个参数作为独立的字符串处理
- `$*` 会把所有的参数当作一个整体

```bash

args() {
  for arg in "$@"; do
    echo "$arg"
  done
}

args "one" "two" "three"
```

输出：

```
one
two
three
```

---


## 4. 局部变量与全局变量

### 4.1 局部变量

Shell 函数内的变量默认是**全局变量**，这意味着在函数外部也能访问它们。如果想在函数内部定义**局部变量**，可以使用 `local` 关键字：

```bash

myfunc() {
  local a=10
  echo "局部变量 a = $a"
}

myfunc
# echo $a  # 这里会报错，因为 a 是局部变量
```

### 4.2 全局变量

函数外部定义的变量是全局的，函数内也能访问和修改：

```bash

var=5

myfunc() {
  echo "全局变量 var = $var"
}

myfunc  # 输出：全局变量 var = 5
```

---

