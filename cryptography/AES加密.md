# AES加密

AES（**Advanced Encryption Standard，高级加密标准**）是一种 **对称加密算法**，由美国国家标准与技术研究院（NIST）在 2001 年正式公布。  
它替代了 **DES**（Data Encryption Standard），成为当前最广泛使用的 **分组加密（Block Cipher）** 算法。

### **AES 主要特点**
✅ **安全性高**：抵御已知攻击，如差分攻击、线性攻击、暴力破解等  
✅ **密钥长度可变**：128/192/256 位，密钥越长，安全性越高  
✅ **速度快**：支持硬件加速（如 AES-NI 指令集）  
✅ **广泛应用**：HTTPS、VPN、磁盘加密、数据库加密  

---

## **1. AES 的工作原理**
AES 是 **分组加密** 算法，每次处理 **128 位（16 字节）** 的数据块。  
密钥长度可以是：
- **AES-128**（密钥 128 位）
- **AES-192**（密钥 192 位）
- **AES-256**（密钥 256 位）

### **AES 加密流程**
AES 使用 **多轮加密**（Rounds），不同密钥长度对应不同轮数：

| **密钥长度** | **轮数（Rounds）** |
|------------|----------------|
| AES-128 | 10 轮 |
| AES-192 | 12 轮 |
| AES-256 | 14 轮 |

**每轮加密包含 4 个步骤：**
1. **字节代换（SubBytes）**：使用 S 盒（S-Box）进行非线性代换，增强抗攻击能力
2. **行移位（ShiftRows）**：打乱数据顺序，防止相关性
3. **列混淆（MixColumns）**：通过数学变换增加数据扩散性（最后一轮不执行）
4. **轮密钥加（AddRoundKey）**：与子密钥 XOR 操作，增加密钥影响

---

## **2. AES 加密流程详解**
假设我们加密 **"Hello, AES!"**（示例为 AES-128）。

### **(1) 明文（Plaintext）**
输入明文必须是 **16 字节（128 位）**：
```
48 65 6C 6C 6F 2C 20 41 45 53 21 00 00 00 00 00  (Hello, AES!)
```

### **(2) 轮密钥加（AddRoundKey）**
- 初始状态矩阵（4×4 矩阵）：
  ```
  H   e   l   l
  o   ,       A
  E   S   !   0
  0   0   0   0
  ```
- 初始轮密钥 XOR 处理，得到新的状态矩阵。

### **(3) 字节代换（SubBytes）**
- 每个字节通过 **S 盒（S-Box）** 替换，提高抗攻击能力：
  ```
  19   3D   E3   BE
  99   2B   7E   42
  23   88   2F   A6
  99   EC   4D   27
  ```

### **(4) 行移位（ShiftRows）**
- 按 **行** 进行循环左移：
  ```
  19   3D   E3   BE
  2B   7E   42   99
  2F   A6   23   88
  27   99   EC   4D
  ```

### **(5) 列混淆（MixColumns）**
- 进行矩阵变换，提高数据扩散性（最后一轮跳过）。

### **(6) 轮密钥加（AddRoundKey）**
- 再次 XOR 轮密钥，进入下一轮。

### **(7) 经过 10 轮（AES-128）后，最终输出密文**
  ```
  0A 6F 44 3D 2B 4D 47 9F 56 71 99 30 2F 2B 43 C7
  ```
- 这个密文看起来是 **随机的**，无法轻易恢复成明文。

---

## **3. AES 解密**
解密过程 **逆向执行** 加密步骤：
1. **轮密钥加（AddRoundKey）**
2. **逆列混淆（Inverse MixColumns）**
3. **逆行移位（Inverse ShiftRows）**
4. **逆字节代换（Inverse SubBytes）**

最终恢复原始明文。

---

## **4. AES 的工作模式**
AES 仅能加密 **16 字节块**，所以需要 **分组模式（Block Cipher Mode）** 处理大数据。

| **模式** | **特点** | **是否推荐** |
|---------|---------|-----------|
| **ECB（电子密码本模式）** | 明文相同，密文相同，不安全 | ❌ |
| **CBC（密码分组链接模式）** | 需要初始化向量（IV），安全性高 | ✅ |
| **CFB（密码反馈模式）** | 适用于流加密 | ✅ |
| **OFB（输出反馈模式）** | 可用于无线通信 | ✅ |
| **CTR（计数器模式）** | 可并行加密，速度快 | ✅ |
| **GCM（Galois/Counter Mode）** | 结合 CTR + 认证，最安全 | 🚀✅ |

**推荐**：
- **AES-GCM**：适用于 HTTPS、TLS，提供 **加密+认证**
- **AES-CBC**：适用于磁盘、数据库加密（需安全管理 IV）

---
