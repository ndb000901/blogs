# 伪随机生成器 PRG

**伪随机生成器（PRG，Pseudorandom Generator）**，它是比 PRF 更基础的密码学组件，是生成伪随机比特流的关键机制。

---

## 1. PRG

**定义：**
> 伪随机生成器（PRG）是一个**可确定性扩展种子**的小程序，它接收一个短的随机种子，输出一个更长的、看起来像随机数的比特流。

数学上：
```
PRG: {0,1}^n → {0,1}^m  (m > n)
```

比如：

```c
input  : 128-bit seed
output : 1024-bit stream  看起来是随机的
```

### 特性：
1. **扩展性**：输出比输入长很多。
2. **不可预测性**：知道前 N 位，也无法推测后面的比特。
3. **高熵伪随机性**：对不知 seed 的人来说，输出像真正的随机数。

---

## 2. PRG 和 PRF 的区别

| | PRG | PRF |
|---|---|---|
| 输入 | 种子（短） | 密钥 + 任意输入 |
| 输出 | 一段连续的“伪随机”比特流 | 每个输入对应一个输出 |
| 应用 | 流加密、密钥扩展、盐生成 | MAC、密钥派生、签名等 |
| 可预期性 | 不可预测后续位 | 不可预测输出 |

---

## 3. 常见的 PRG 实现方式

### 基于对称密码构造的 PRG
- 用 **分组加密算法**（如 AES）反复对计数器加密：
```text
PRG(seed) = AES(seed, 0) || AES(seed, 1) || AES(seed, 2) ...
```
也叫 CTR 模式的伪随机生成器。

### 基于密码哈希构造
```text
PRG(seed) = SHA256(seed || 0) || SHA256(seed || 1) ...
```



