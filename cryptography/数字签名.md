# **数字签名详解**

数字签名（Digital Signature）是一种 **基于公钥密码学** 的技术，用于确保数据的 **完整性、真实性和不可否认性**。它可以理解为电子世界中的 **手写签名** 或 **印章**，但更安全且不可伪造。

---

## **1. 数字签名的作用**
数字签名的核心作用包括：
1. **数据完整性**：保证数据未被篡改。
2. **身份认证**：确保发送者身份的真实性。
3. **不可否认性**：发送者无法否认已发送的数据。

例如，数字签名广泛用于 **SSL/TLS 证书（HTTPS）、电子合同、软件签名、区块链交易** 等场景。

---

## **2. 数字签名的基本原理**
数字签名通常由 **哈希函数** 和 **非对称加密** 组成，主要流程如下：

### **（1）签名过程**
1. 发送者（Alice）使用 **哈希函数**（如 SHA-256）计算消息 `M` 的哈希值 `H(M)`：
```text
H(M)=SHA-256(M)
```
2. Alice 用 **私钥 `SK`** 对 `H(M)` 进行加密，生成数字签名 `S`：
```text
S = Encrypt(SK,H(M))
```

3. Alice 发送 **`(M, S)`** 给接收者 Bob。

### **（2）验证过程**

1. Bob 先用 **相同的哈希函数** 计算接收到的 `M` 的哈希值 `H(M')`：
```text
H(M') = SHA-256(M')
```

2. Bob 用 Alice 的 **公钥 `PK`** 解密签名 `S`，得到 `H(M)`：
```text
H(M) = Decrypt(PK,S)
```
3. Bob 比较 `H(M)` 和 `H(M')`：
   - 若 **H(M) == H(M')**，签名有效，数据未被篡改。
   - 若 **H(M) ≠ H(M')**，说明数据被篡改或签名无效。

---

## **3. 数字签名的常见算法**
### **3.1 RSA 数字签名**
RSA 签名是基于 **RSA 非对称加密算法** 的签名方法，安全性依赖于 **大数因子分解难题**。

- **签名**：私钥加密哈希值
- **验证**：公钥解密签名并比对哈希值

**优点**：
✅ 安全性较高  
✅ 易于实现，广泛应用于 SSL/TLS  

**缺点**：
❌ 签名速度较慢，密钥长度需要较长（2048 位以上）  
❌ 密文较长，占用存储空间大  

### **3.2 DSA（数字签名算法）**
DSA（Digital Signature Algorithm）是 NIST（美国国家标准与技术研究院）制定的签名算法，基于 **离散对数难题**。

- **签名**：使用私钥计算 `(r, s)`
- **验证**：使用公钥验证 `(r, s)`

**优点**：
✅ 计算速度比 RSA 快  
✅ 签名长度较短  

**缺点**：
❌ 需要高质量的随机数生成，否则容易被破解（如 DSA 的 k 重复攻击）  

### **3.3 ECDSA（椭圆曲线 DSA）**
ECDSA 是 DSA 的 **椭圆曲线版本**，基于 **椭圆曲线离散对数问题（ECDLP）**，比传统 DSA 和 RSA 更高效。

**优点**：
✅ **密钥更短**（256 位 ECDSA ≈ 3072 位 RSA）  
✅ **计算速度更快**，适用于区块链、移动设备等  

**缺点**：
❌ 需要精细的参数选择，容易受到侧信道攻击  

### **3.4 EdDSA（Ed25519 / Ed448）**
EdDSA（Edwards-curve Digital Signature Algorithm）是一种 **更安全、更高效的椭圆曲线签名算法**。

- **常见实现**：
  - Ed25519（基于 Curve25519）
  - Ed448（基于 Curve448）

**优点**：
✅ 计算速度更快，抗侧信道攻击  
✅ 签名长度固定，适用于高安全应用  

**缺点**：
❌ 由于是新算法，部分老旧系统不支持  

---

