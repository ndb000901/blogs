# top命令

`top` 是 Linux 系统中一个非常常用的性能监控工具，用于实时查看系统的各项资源使用情况，如 CPU、内存、进程等。它以动态刷新显示的方式提供了系统性能的快照。

## 1. 启动 `top`

在终端中输入：
```bash

top
```

## 2. `top` 的界面结构
`top` 命令的输出分为两部分：**系统信息部分** 和 **进程信息部分**。

### 系统信息（在顶部）
显示系统的摘要信息，通常包括以下内容：

- **System uptime**：系统的运行时间，例如 `up 5 days, 2:30` 表示系统已经运行了5天2小时30分钟。
- **Users**：当前登录到系统的用户数。
- **Load average**：系统负载平均值，通常分为 1 分钟、5 分钟、15 分钟的平均值。例如 `load average: 0.30, 0.25, 0.20`。
- **Tasks**：当前进程的总数，分为正在运行的、休眠的、停止的、僵尸进程等。
- **CPU Usage**：CPU 的使用情况，包括：
    - **us**：用户空间占用的 CPU 比例。
    - **sy**：内核空间占用的 CPU 比例。
    - **ni**：用户空间中改变优先级的进程占用的 CPU 比例。
    - **id**：空闲 CPU 比例。
    - **wa**：等待 I/O 的 CPU 比例。
    - **hi**：硬件中断占用的 CPU 比例。
    - **si**：软件中断占用的 CPU 比例。
    - **st**：虚拟机占用的 CPU 比例（如果有虚拟化环境）。

- **Memory Usage**：内存使用情况，包括：
    - **total**：总内存。
    - **free**：空闲内存。
    - **buffers**、**cached**：文件缓存和缓冲区使用的内存。
    - **used**：已用内存。
    - **swap**：交换空间的使用情况。

### 2. 进程信息
显示系统中各个进程的详细信息。每行代表一个进程，包含以下列信息：

- **PID**：进程 ID。
- **USER**：进程的所有者。
- **PR**：进程优先级（priority）。
- **NI**：进程的优先级调整值（nice value）。
- **VIRT**：进程使用的虚拟内存总量。
- **RES**：进程使用的物理内存总量。
- **SHR**：进程共享的内存大小。
- **S**：进程状态（如 `S` 表示休眠状态，`R` 表示运行状态）。
- **%CPU**：进程使用的 CPU 比例。
- **%MEM**：进程使用的内存比例。
- **TIME+**：进程使用的 CPU 时间总和。
- **COMMAND**：进程的命令行。

### `top` 命令的一些常用选项和操作

- **`top` 启动时显示指定用户的进程**
  ```bash
  top -u <username>
  ```
  显示指定用户的进程信息。

- **排序方式**
  按照不同字段进行排序：
    - 按 CPU 占用排序：按 `%CPU` 列排序。
    - 按内存占用排序：按 `%MEM` 列排序。
    - 在 `top` 界面中，可以通过按下 `P` 来按 CPU 使用率排序，按下 `M` 来按内存使用率排序。

- **交互命令**
  在 `top` 的界面中，您可以使用以下快捷键来调整显示和行为：
    - **`q`**：退出 `top`。
    - **`P`**：按 CPU 使用率排序。
    - **`M`**：按内存使用率排序。
    - **`T`**：按时间/累计时间排序。
    - **`R`**：反转排序顺序。
    - **`c`**：切换显示命令行和命令的全路径。
    - **`k`**：杀死一个进程。输入 PID 后，可以选择终止进程。
    - **`h`**：显示帮助文档。

- **更新频率**
  默认情况下，`top` 会每 3 秒刷新一次屏幕。你可以通过按下 `d` 键并输入一个新的刷新时间（单位是秒）来更改刷新频率。

- **`top` 命令的其他实用选项**
    - **`-n <count>`**：指定 `top` 刷新显示的次数后退出。例如 `top -n 5` 会显示 5 次更新后退出。
    - **`-d <seconds>`**：指定屏幕刷新时间的间隔。例如 `top -d 1` 每秒刷新一次。
    - **`-b`**：以批处理模式启动，适合用于输出重定向。
    - **`-i`**：忽略所有没有占用 CPU 的进程。

