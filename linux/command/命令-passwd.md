# passwd 命令

`passwd` 是 Linux/Unix 系统中用于 **修改用户密码** 的命令。普通用户可以使用它修改自己的密码，系统管理员（`root`）可以修改任何用户的密码，也可设置密码过期策略等。


## 1. 基本命令格式

```bash

passwd [选项] [用户名]
```

- 如果不指定用户名，则默认修改当前用户的密码。
- 仅 `root` 用户可以为其他用户修改密码。

---

## 2. 常用选项

| 选项 | 说明 |
|------|------|
| `-d` | 删除用户密码（该用户登录时不再需要密码） |
| `-e` | 强制用户下次登录时必须更改密码（立即过期） |
| `-l` | 锁定账号（禁止登录） |
| `-u` | 解锁账号 |
| `-S` | 显示用户密码状态 |
| `-x DAYS` | 设置密码最大有效期 |
| `-n DAYS` | 设置密码最小使用天数 |
| `-w DAYS` | 设置密码到期前多少天开始警告 |
| `-i DAYS` | 密码过期多少天后禁用账号 |

---

## 3. 密码策略相关文件

- `/etc/passwd`：存储基本用户信息。
- `/etc/shadow`：存储加密后的密码和密码策略。
- `/etc/login.defs`：默认密码策略配置文件。

---

## 4. 使用示例

### 4.1 修改当前用户的密码

```bash

passwd
```
会提示输入旧密码、新密码并确认。

---

### 4.2 root 为指定用户修改密码

```bash

sudo passwd username
```
无须原密码，直接设置新密码。

---

### 4.3 删除密码（用户登录时不需要密码）

```bash

sudo passwd -d username
```
清除密码，仅适用于无风险用户或自动登录场景。

---

### 4.4 锁定账号（禁止登录）

```bash

sudo passwd -l username
```
将用户名前加上 `!`，禁止其登录系统。

---

### 4.5 解锁账号

```bash

sudo passwd -u username
```
恢复被锁定的用户。

---

### 4.6 设置密码过期策略

```bash

sudo passwd -x 90 -n 1 -w 7 -i 30 username
```

含义：
- 密码最多使用 90 天（`-x`）
- 修改后至少要过 1 天才可再次修改（`-n`）
- 到期前 7 天开始警告（`-w`）
- 密码过期后 30 天内不改将锁定账号（`-i`）

---

### 4.7 查看用户密码状态

```bash

sudo passwd -S username
```
输出类似：
```
username P 04/10/2025 0 99999 7 -1
```
含义：
- `P` 表示密码已设置（`L` 表示已锁定，`NP` 表示未设置密码）
- 后续数字是密码策略参数

---

## 5. 与密码相关的额外命令

| 命令 | 说明 |
|------|------|
| `chage` | 更详细的密码过期设置 |
| `passwd -e` | 让用户下次登录必须修改密码 |
| `passwd -S` | 查看当前密码状态 |
| `sudo passwd -l` | 锁定账户 |
| `sudo passwd -u` | 解锁账户 |

---
